<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Decision Tree 기하학적 시각화</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .canvas-container {
            text-align: center;
            margin: 20px 0;
        }
        canvas {
            border: 2px solid #333;
            border-radius: 5px;
        }
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid #333;
        }
        .info {
            background: #f0f8ff;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🌳 Decision Tree: 2D 기하학적 분할</h1>
        
        <div class="info">
            <h3>📊 데이터셋: 온도 vs 습도로 운동 여부 예측</h3>
            <p><strong>X축:</strong> 온도 (°C) | <strong>Y축:</strong> 습도 (%)</p>
        </div>

        <div class="canvas-container">
            <canvas id="treeCanvas" width="600" height="400"></canvas>
        </div>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background-color: #ff6b6b;"></div>
                <span>운동 안함 ❌</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #51cf66;"></div>
                <span>운동함 ✅</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #333;"></div>
                <span>Decision Boundary</span>
            </div>
        </div>

        <div style="text-align: center;">
            <button onclick="showStep(1)">1단계: 온도 분할</button>
            <button onclick="showStep(2)">2단계: 습도 분할</button>
            <button onclick="showStep(3)">3단계: 최종 결과</button>
            <button onclick="showStep(0)">전체 보기</button>
        </div>

        <div class="info" id="stepInfo">
            <h3>🔍 Decision Tree 분할 과정</h3>
            <p>버튼을 클릭해서 단계별 분할 과정을 확인해보세요!</p>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('treeCanvas');
        const ctx = canvas.getContext('2d');
        
        // 데이터 포인트들 (온도, 습도, 클래스)
        const dataPoints = [
            {x: 15, y: 80, class: 0, label: '추위+습함'}, // 운동 안함
            {x: 18, y: 75, class: 0, label: '추위+습함'},
            {x: 12, y: 90, class: 0, label: '추위+습함'},
            {x: 25, y: 85, class: 0, label: '적당+습함'}, // 운동 안함 (너무 습함)
            {x: 28, y: 90, class: 0, label: '적당+습함'},
            {x: 35, y: 80, class: 0, label: '더움+습함'}, // 운동 안함 (덥고 습함)
            {x: 38, y: 85, class: 0, label: '더움+습함'},
            {x: 25, y: 40, class: 1, label: '적당+건조'}, // 운동함
            {x: 28, y: 35, class: 1, label: '적당+건조'},
            {x: 30, y: 45, class: 1, label: '적당+건조'},
            {x: 32, y: 30, class: 1, label: '적당+건조'},
            {x: 22, y: 50, class: 1, label: '적당+건조'},
            {x: 35, y: 40, class: 1, label: '따뜻+건조'}, // 운동함
            {x: 38, y: 35, class: 1, label: '따뜻+건조'},
        ];

        let currentStep = 0;

        function drawBackground() {
            ctx.fillStyle = '#f8f9fa';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        function transformCoord(temp, humidity) {
            // 온도: 10-40°C -> 50-550px
            // 습도: 20-100% -> 350-50px (Y축 뒤집기)
            const x = 50 + (temp - 10) * 500 / 30;
            const y = 350 - (humidity - 20) * 300 / 80;
            return {x, y};
        }

        function drawAxes() {
            ctx.strokeStyle = '#666';
            ctx.lineWidth = 2;
            
            // X축 (온도)
            ctx.beginPath();
            ctx.moveTo(50, 350);
            ctx.lineTo(550, 350);
            ctx.stroke();
            
            // Y축 (습도)
            ctx.beginPath();
            ctx.moveTo(50, 50);
            ctx.lineTo(50, 350);
            ctx.stroke();
            
            // 축 레이블
            ctx.fillStyle = '#333';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            
            // X축 눈금
            for(let temp = 10; temp <= 40; temp += 10) {
                const pos = transformCoord(temp, 20);
                ctx.fillText(temp + '°C', pos.x, 370);
            }
            
            // Y축 눈금
            ctx.textAlign = 'right';
            for(let humidity = 20; humidity <= 100; humidity += 20) {
                const pos = transformCoord(10, humidity);
                ctx.fillText(humidity + '%', 45, pos.y + 5);
            }
            
            // 축 제목
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('온도 (Temperature)', 300, 390);
            
            ctx.save();
            ctx.translate(25, 200);
            ctx.rotate(-Math.PI/2);
            ctx.fillText('습도 (Humidity)', 0, 0);
            ctx.restore();
        }

        function drawDataPoints() {
            dataPoints.forEach(point => {
                const pos = transformCoord(point.x, point.y);
                
                ctx.beginPath();
                ctx.arc(pos.x, pos.y, 8, 0, 2 * Math.PI);
                ctx.fillStyle = point.class === 1 ? '#51cf66' : '#ff6b6b';
                ctx.fill();
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 2;
                ctx.stroke();
            });
        }

        function drawDecisionBoundary(step) {
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 3;
            ctx.setLineDash([5, 5]);
            
            // 좌표 미리 계산
            const temp25 = transformCoord(25, 20);
            const humidity65 = transformCoord(25, 65);
            
            if (step >= 1) {
                // 1단계: 온도 25°C로 분할
                ctx.beginPath();
                ctx.moveTo(temp25.x, 50);
                ctx.lineTo(temp25.x, 350);
                ctx.stroke();
                
                // 레이블
                ctx.fillStyle = '#333';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('온도 < 25°C', temp25.x - 60, 30);
                ctx.fillText('온도 ≥ 25°C', temp25.x + 60, 30);
            }
            
            if (step >= 2) {
                // 2단계: 온도 ≥ 25인 영역을 습도 65%로 분할
                ctx.beginPath();
                ctx.moveTo(temp25.x, humidity65.y);
                ctx.lineTo(550, humidity65.y);
                ctx.stroke();
                
                // 레이블
                ctx.textAlign = 'left';
                ctx.fillText('습도 ≥ 65%', temp25.x + 10, humidity65.y - 10);
                ctx.fillText('습도 < 65%', temp25.x + 10, humidity65.y + 20);
            }
            
            ctx.setLineDash([]);
        }

        function drawRegions(step) {
            if (step < 3) return;
            
            ctx.globalAlpha = 0.2;
            
            // 왼쪽 영역 (온도 < 25): 운동 안함
            ctx.fillStyle = '#ff6b6b';
            ctx.fillRect(50, 50, transformCoord(25, 20).x - 50, 300);
            
            // 오른쪽 위 영역 (온도 ≥ 25, 습도 ≥ 65): 운동 안함
            const temp25 = transformCoord(25, 20);
            const humidity65 = transformCoord(25, 65);
            ctx.fillRect(temp25.x, 50, 500, humidity65.y - 50);
            
            // 오른쪽 아래 영역 (온도 ≥ 25, 습도 < 65): 운동함
            ctx.fillStyle = '#51cf66';
            ctx.fillRect(temp25.x, humidity65.y, 500, 300 - (humidity65.y - 50));
            
            ctx.globalAlpha = 1;
        }

        function updateStepInfo(step) {
            const info = document.getElementById('stepInfo');
            const messages = [
                '<h3>🔍 전체 Decision Tree</h3><p>모든 분할 경계와 최종 분류 영역을 보여줍니다.</p>',
                '<h3>1️⃣ 1단계: 온도로 분할</h3><p><strong>온도 < 25°C:</strong> 너무 추워서 운동 안함<br><strong>온도 ≥ 25°C:</strong> 적당한 온도, 추가 분할 필요</p>',
                '<h3>2️⃣ 2단계: 습도로 세분화</h3><p><strong>온도 ≥ 25°C & 습도 ≥ 65%:</strong> 너무 습해서 운동 안함<br><strong>온도 ≥ 25°C & 습도 < 65%:</strong> 운동하기 좋은 조건!</p>',
                '<h3>3️⃣ 최종 결과</h3><p>🔴 빨간 영역: 운동 안함<br>🟢 초록 영역: 운동함<br><br>Decision Tree가 2D 공간을 직사각형 영역들로 분할하는 것을 확인할 수 있습니다!</p>'
            ];
            info.innerHTML = messages[step];
        }

        function showStep(step) {
            currentStep = step;
            drawBackground();
            drawAxes();
            
            if (step >= 3 || step === 0) {
                drawRegions(3);
            }
            
            drawDecisionBoundary(step === 0 ? 2 : step);
            drawDataPoints();
            
            updateStepInfo(step);
        }

        // 초기 화면
        showStep(0);
    </script>
</body>
</html>